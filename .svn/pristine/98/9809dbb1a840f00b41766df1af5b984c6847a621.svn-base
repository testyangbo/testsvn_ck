import { Page } from '@playwright/test';
import { TEST_Menu } from '../data/testmenu';

/**
 * OpenTheMenuPage 类
 * 
 * 该类封装了与菜单操作相关的页面交互方法，
 * 主要用于在测试过程中打开指定的子菜单。
 */
export class OpenTheMenuPage {
    private  page: Page;

    /**
     * 构造函数
     * @param page Playwright Page 对象
     */
    constructor(page: Page) { 
        this.page = page;
    }

    /**
     * 打开指定名称的子菜单
     * @param MainMenuName 主菜单名称
     * @param childMenuName 子菜单名称
     */
    async openMenu(MainMenuName: string, childMenuName: string) {
        console.log(`打开菜单: ${MainMenuName} -> ${childMenuName}`);
        await this.page.getByText(MainMenuName, { exact: true }).hover();
        await this.page.locator('css=.menu-popo').getByText(childMenuName, { exact: true }).click();
        // 等待页面加载完成，使用domcontentloaded替代networkidle以避免超时
        await this.page.waitForLoadState('domcontentloaded');
    }

    /**
     * 关闭指定名称的子菜单
     * @param childMenuName 子菜单名称
     */
    async closeMenu(childMenuName: string) {
        await this.page.getByRole('tab', { name: `${childMenuName} ` }).locator('span').click();
    }
}